<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>L·ªãch h·∫πn s·∫Øp t·ªõi - Punky Spa</title>
  {% load static %}
  <link rel="stylesheet" href="{% static 'lichhen/style.css' %}">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <style>
    .message {
      text-align: center;
      font-weight: 500;
      padding: 8px;
      margin-bottom: 10px;
      border-radius: 8px;
    }
    .message.success {
      background-color: #e6ffe9;
      color: #1e7a1e;
      border: 1px solid #8cd48c;
    }
    .message.error {
      background-color: #ffe6e6;
      color: #b91c1c;
      border: 1px solid #f5b5b5;
    }
  </style>
</head>

<body>
  <div class="container">
    <!-- üîπ Sidebar -->
    <aside class="sidebar">
      <div class="logo">
        <img src="{% static 'trangchu/logo.png' %}" alt="Punky Spa">
        <h2><span class="pink">Punky</span> Spa</h2>
      </div>

      <div class="user-info">
        <i class="fa fa-user"></i> {{ request.user.username }}
      </div>

      <nav>
        <a href="{% url 'home' %}">Trang ch·ªß</a>
        <div class="dropdown">
          <button class="drop-btn">L·ªãch h·∫πn</button>
          <div class="dropdown-content">
            <a href="{% url 'lich_hen_sap_toi' %}" class="active">L·ªãch h·∫πn s·∫Øp t·ªõi</a>
            <a href="{% url 'lich_su_lich_hen' %}">L·ªãch s·ª≠ l·ªãch h·∫πn</a>
            <a href="{% url 'lich_da_huy' %}">L·ªãch ƒë√£ h·ªßy</a>
          </div>
        </div>
      </nav>
    </aside>

    <!-- üîπ Main content -->
    <main class="main-content">
      <h2>L·ªãch h·∫πn s·∫Øp t·ªõi</h2>
      <a href="{% url 'them_lich_hen' %}" class="add-btn">Th√™m l·ªãch h·∫πn +</a>

      <!-- ‚úÖ Hi·ªÉn th·ªã th√¥ng b√°o th√†nh c√¥ng ho·∫∑c l·ªói -->
      {% if messages %}
        {% for message in messages %}
          <div class="message {% if message.tags == 'success' %}success{% elif message.tags == 'error' %}error{% endif %}">
            {{ message }}
          </div>
        {% endfor %}
      {% endif %}

      <table class="schedule-table">
        <thead>
          <tr>
            <th>Th·ªùi gian</th>
            <th>T√™n kh√°ch h√†ng</th>
            <th>SDT</th>
            <th>T√™n th√∫ c∆∞ng</th>
            <th>Lo√†i</th>
            <th>C√¢n n·∫∑ng</th>
            <th>D·ªãch v·ª•</th>
            <th>Nh√¢n vi√™n</th>
            <th>Ghi ch√∫</th>
            <th>Thao t√°c</th>
          </tr>
        </thead>

        <tbody>
          {% for lh in lich_hens %}
          <tr>
            <td>{{ lh.thoi_gian|date:"H:i d/m/Y" }}</td>
            <td>{{ lh.khach_hang.ho_ten }}</td>
            <td>{{ lh.so_dien_thoai }}</td>
            <td>{{ lh.thu_cung.ten_thucung }}</td>
            <td>{{ lh.thu_cung.loai }}</td>
            <td>{{ lh.thu_cung.can_nang }}</td>
            <td>
              {% for dv in lh.dv_lichhen_set.all %}
                {{ dv.dich_vu.ten_dich_vu }}{% if not forloop.last %}, {% endif %}
              {% endfor %}
            </td>
            <td>{% if lh.nhan_vien %}{{ lh.nhan_vien.user.get_full_name }}{% else %}-{% endif %}</td>
            <td>{{ lh.ghi_chu }}</td>
            <td>
              <a href="{% url 'sua_lich_hen' lh.id %}" class="edit-btn">‚úèÔ∏è</a>
              <a href="{% url 'xoa_lich_hen' lh.id %}" class="delete-btn">üóëÔ∏è</a>
            </td>
          </tr>
          {% empty %}
          <tr><td colspan="10">Kh√¥ng c√≥ l·ªãch h·∫πn n√†o s·∫Øp t·ªõi.</td></tr>
          {% endfor %}
        </tbody>
      </table>
    </main>
  </div>

  <!-- üïì T·ª± ·∫©n message sau 4 gi√¢y -->
  <script>
    setTimeout(() => {
      document.querySelectorAll('.message').forEach(el => el.remove());
    }, 4000);
  </script>
</body>
</html>
