{% load static %}
<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <title>{% block title %}Punky Spa{% endblock %}</title>

    <!-- ğŸŒ¸ LiÃªn káº¿t CSS -->
    <link rel="stylesheet" href="{% static 'trangchu/style.css' %}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
</head>

<body>
<!-- ğŸŒ¸ HIá»‚N THá»Š THÃ”NG BÃO THÃ€NH CÃ”NG / Lá»–I -->
{% if messages %}
<div class="messages">
  {% for message in messages %}
    <div class="alert alert-{{ message.tags }}" style="background:#ffedf3; color:#e2617a; padding:10px; margin:10px 0; border-radius:8px;">
      {{ message }}
    </div>
  {% endfor %}
</div>
{% endif %}


<!-- ğŸŒ¸ THANH TRÃŠN CÃ™NG -->
<div class="topbar">
    <div class="topbar-left">
        <i class="fa fa-calendar"></i>
        <strong>Giá» lÃ m viá»‡c:</strong> Tá»« 09h00 Ä‘áº¿n 21h00
    </div>

    <div class="right">
        {% if user.is_authenticated %}
        <!-- ğŸ”” Náº¿u Ä‘Ã£ Ä‘Äƒng nháº­p -->
        <div class="notify-box">
            <span class="notify-icon">ğŸ””</span>
            <span class="badge">{{ so_thong_bao_chua_doc }}</span>
            <div class="notify-content">
                <div class="notify-list">
                    {% for tb in thong_baos_moi %}
                        <a href="{% url 'TB:xem_thong_bao' tb.id %}"
                           class="notify-item {% if not tb.da_doc %}chua-doc{% endif %}"
                           style="display:block; text-decoration:none; color:#333; padding:8px 10px; border-radius:8px; margin-bottom:5px; transition:0.3s;">

                            <div style="font-weight:600; color:#e75480;">
                                {% if not tb.da_doc %}ğŸ”” {% endif %}{{ tb.tieu_de }}
                            </div>
                            <small style="color:#777;">{{ tb.ngay_tao|date:"d/m/Y H:i" }}</small>
                        </a>
                    {% empty %}
                        <p style="text-align:center;">KhÃ´ng cÃ³ thÃ´ng bÃ¡o má»›i.</p>
                    {% endfor %}
                </div>
                <a href="{% url 'TB:trang_thong_bao' %}" class="view-all">Xem táº¥t cáº£</a>
            </div>
        </div>

        <!-- MENU TÃ€I KHOáº¢N -->
        <div class="user-menu">
            <button class="user-btn">
                <i class="fa fa-user"></i> {{ user.username }}
                <i class="fa fa-caret-down"></i>
            </button>

            <div class="dropdown-menu">

                <div class="submenu">
                    <a href="#" class="submenu-toggle">
                       <i class="fa fa-user-circle"></i> TÃ i khoáº£n <i class="fa fa-caret-down"></i>
                    </a>
                    <div class="submenu-items">
                       <a href="{% url 'thongtintaikhoan' %}"><i class="fa fa-id-card"></i> ThÃ´ng tin cÃ¡ nhÃ¢n</a>
                    </div>
                </div>


                <a href="{% url 'thongtintaikhoan' %}"><i class="fa fa-star"></i> TÃ i khoáº£n</a>

                <a href="#"><i class="fa fa-star"></i> TÃ­ch Ä‘iá»ƒm</a>
                <a href="#"><i class="fa fa-ticket"></i> MÃ£ Æ°u Ä‘Ã£i</a>
                <a href="{% url 'lich_hen_sap_toi' %}"><i class="fa fa-calendar"></i> Lá»‹ch háº¹n</a>
                <a href="#"><i class="fa fa-comments"></i> Khiáº¿u náº¡i</a>
                <a href="{% url 'dangxuat' %}"><i class="fa fa-sign-out-alt"></i> ÄÄƒng xuáº¥t</a>
                <a href="{% url 'xoa_tai_khoan' %}" class="delete-account"><i class="fa fa-trash"></i> XÃ³a tÃ i khoáº£n</a>
            </div>
        </div>

        {% else %}
        <!-- ğŸ”¹ Náº¿u chÆ°a Ä‘Äƒng nháº­p -->
        <div class="notify-box">
            <span class="notify-icon">ğŸ””<span class="notify-count">{{ thong_baos_moi|length }}</span></span>
            <div class="notify-content">
                <div style="text-align:center; padding:15px;">
                    <img src="{% static 'trangchu/notify-cat.png' %}" alt="MÃ¨o dá»… thÆ°Æ¡ng" class="notify-image">
                    <p>ÄÄƒng nháº­p Ä‘á»ƒ xem thÃ´ng bÃ¡o</p>
                    <a href="{% url 'dangnhap' %}" class="btn">ÄÄƒng nháº­p</a>
                    <a href="{% url 'dangky' %}" class="btn">ÄÄƒng kÃ½</a>
                </div>
            </div>
        </div>
        <a href="{% url 'dangnhap' %}">ÄÄƒng nháº­p</a> |
        <a href="{% url 'dangky' %}">ÄÄƒng kÃ½</a>
        {% endif %}
    </div>
</div>

<!-- ğŸŒ¸ HEADER CHÃNH -->
<header class="navbar">
    <div class="logo">
        <img src="{% static 'trangchu/logo.png' %}" alt="Logo Punky Spa">
        <h1><span class="pink">Punky</span> Spa</h1>
    </div>

    <nav>
        <a href="{% url 'home' %}" class="{% if request.resolver_match.url_name == 'home' %}active{% endif %}">Trang chá»§</a>
        <a href="{% url 'danh_sach_dich_vu' %}" class="{% if request.resolver_match.url_name == 'danh_sach_dich_vu' %}active{% endif %}">Dá»‹ch vá»¥</a>
        <a href="{% url 'TB:danh_sach_khuyen_mai' %}"
           class="nav-link {% if request.resolver_match.url_name == 'danh_sach_khuyen_mai' %}active{% endif %}">
           Khuyáº¿n mÃ£i</a>
        <a href="{% url 'lien_he' %}" class="{% if request.resolver_match.url_name == 'lien_he' %}active{% endif %}">LiÃªn há»‡</a>
    </nav>

    <div class="search">
        <input type="text" placeholder="TÃ¬m kiáº¿m...">
        <button>ğŸ”</button>
    </div>
</header>

<!-- ğŸŒ¸ VÃ™NG Ná»˜I DUNG CHÃNH -->
{% block content %}
{% endblock %}

<!-- ğŸŒ¸ FOOTER -->
<footer class="footer">
    <div class="footer-container">
        <div class="footer-column">
            <h4>LiÃªn láº¡c</h4>
            <p>Hotline: 1900 6750</p>
            <p>Äá»‹a chá»‰: 627 NgÃ´ Quyá»n, An Háº£i Báº¯c,<br>ÄÃ  Náºµng, Viá»‡t Nam</p>
        </div>

        <div class="footer-column">
            <h4>ChÃ­nh sÃ¡ch</h4>
            <p>ChÃ­nh sÃ¡ch báº£o máº­t</p>
            <p>Quy Ä‘á»‹nh sá»­ dá»¥ng</p>
        </div>

        <div class="footer-column">
            <h4>Tá»•ng Ä‘Ã i há»— trá»£</h4>
            <p>TÆ° váº¥n dá»‹ch vá»¥: 1800 6750</p>
            <p>Há»— trá»£ sá»­ dá»¥ng: 1900 6750</p>
            <p>Email: punkyspa@gmail.vn</p>
            <p>Tá»« 7h00 â€“ 20h00 cÃ¡c ngÃ y tá»« thá»© 2 Ä‘áº¿n Chá»§ nháº­t.</p>
        </div>
    </div>
</footer>

</body>
</html>
<script>
  // ğŸ”½ Hiá»‡n/áº©n menu tÃ i khoáº£n
  const userBtn = document.querySelector('.user-btn');
  const dropdownMenu = document.querySelector('.dropdown-menu');

  if (userBtn && dropdownMenu) {
    userBtn.addEventListener('click', (e) => {
      e.stopPropagation();
      dropdownMenu.classList.toggle('show');
    });
    document.addEventListener('click', () => dropdownMenu.classList.remove('show'));
  }

  // ğŸ”” Hiá»‡n/áº©n thÃ´ng bÃ¡o
  const notifyBox = document.querySelector('.notify-box');
  const notifyContent = document.querySelector('.notify-content');

  if (notifyBox && notifyContent) {
    notifyBox.addEventListener('click', (e) => {
      e.stopPropagation();
      notifyContent.classList.toggle('show');
    });
    document.addEventListener('click', () => notifyContent.classList.remove('show'));
  }

  // ÄÃ³ng submenu khi click ra ngoÃ i
  document.addEventListener('click', function(e) {
    const submenu = document.querySelector('.submenu-items');
    if (submenu && !e.target.closest('.submenu-toggle')) {
      submenu.style.display = 'none';
    }
  });

  // Má»Ÿ submenu
  const submenuToggle = document.querySelector('.submenu-toggle');
  if (submenuToggle) {
    submenuToggle.addEventListener('click', function(e) {
      e.preventDefault();
      const submenuItems = document.querySelector('.submenu-items');
      if (submenuItems.style.display === 'block') {
        submenuItems.style.display = 'none';
      } else {
        submenuItems.style.display = 'block';
      }
    });
  }
</script>
